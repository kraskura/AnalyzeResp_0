<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>MMR.knit</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.5.1/jquery-3.5.1.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">AnalyzeResp</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="functions.html">Functions</a>
</li>
<li>
  <a href="tutorials-main.html">Demos &amp; Vocab</a>
</li>
<li>
  <a href="troubleshooting.html">Troubleshoting</a>
</li>
<li>
  <a href="references.html">References</a>
</li>
<li>
  <a href="progressNotes.html">Updates</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="about.html">Aquatic respiromtery</a>
    </li>
    <li>
      <a href="QC_protocol.html">QC protocols</a>
    </li>
    <li>
      <a href="workshops.html">Workshops</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="mailto:&lt;kkraskura@ucsb.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://github.com/kraskura/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<div class="page-header">
<h2 style="font-size: 30px; text-align:left;">
MMR: Maximum metabolic rates
</h2>
<p><code>MMR</code> <br></p>
</div>
<h4 style="color:#495057; font-weight: bold;  text-align: left">
About
</h4>
<ul class="breadcrumb" style="background-color:#fff; border:none; color:#3e3f3a">
<li>
<a href="#Arguments">Arguments</a>
</li>
<li>
<a href="#Value">Value</a>
</li>
<li>
<a href="#Details">Details</a>
</li>
<li>
<a href="#Example">Example</a>
</li>
<li>
<a href="https://github.com/kraskura/AnalyzeResp_0/tree/main/Test/MANUAL"><i class="fas fa-download"></i>  See datafiles on GitHub</a>
</li>
</ul>
<h4 style="color:#495057; font-weight: bold;  text-align: left">
Description
</h4>
<!-- <h4 style="color:#495057; font-weight: bold;  text-align: left">Before running the SMR function </h4><br> -->
<p>This function will take files with maximum metabolic rate recordings in up to 4 Channels/animals (8-channel FireSting has 4 oxygen sensor channels and 4 temperature probes). This function finds the steepest oxygen decrease over 60, 90, 120, and 180 second timeframes for each Channel within a specified measurement cycle; it is using a sliding window method (more in <a href="https://doi.org/10.1086/708673">Little et al 2020</a>). The regression slope is estimated for above mentioned time periods and the entire measurement cycle. All non-MMR cycles are analyzed using full time period without the sliding window approach.</p>
<h4>
<a style="color:#495057; font-weight: bold;  text-align: left" name="Arguments">Arguments</a>
</h4>
<table>
<colgroup>
<col width="18%" />
<col width="63%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Argument</th>
<th align="left">Description</th>
<th align="left">Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><strong>data.MMR</strong></td>
<td align="left">The name of the raw input file; <em>.csv</em>, a character.</td>
<td align="left">–</td>
</tr>
<tr class="even">
<td align="right"><strong>cycles</strong></td>
<td align="left">The number of measurement cycles recording metabolic rate in an animal (a single number value 1 through 4).</td>
<td align="left">–</td>
</tr>
<tr class="odd">
<td align="right"><strong>cycle_start</strong></td>
<td align="left">A numeric vector of measurement cycle start times (min). The length of this vector has to be equal to the number of <code>cycles</code> provided, e.g. if <code>cycles = 2</code>, then it may be <code>cycle_start = c(0,10)</code>)</td>
<td align="left">–</td>
</tr>
<tr class="even">
<td align="right"><strong>cycle_end</strong></td>
<td align="left">A numeric vector of measurement cycle end times (min). The same format as cycle_start</td>
<td align="left">–</td>
</tr>
<tr class="odd">
<td align="right"><strong>mmr_Ch1</strong></td>
<td align="left">A number indicated in which cycle the animal in FireSting Channel 1 is expected to reach its maximum metabolic rate. Must specify to analyze metabolic rate, or enter <code>0</code>, which will drop the channel from analysis.</td>
<td align="left"><code>0</code></td>
</tr>
<tr class="even">
<td align="right"><strong>mmr_Ch2</strong></td>
<td align="left">See <code>mmr_Ch1</code> argument for description. This applies to Channel 2</td>
<td align="left">–</td>
</tr>
<tr class="odd">
<td align="right"><strong>mmr_Ch3</strong></td>
<td align="left">See <code>mmr_Ch1</code> argument for description. This applies to Channel 3</td>
<td align="left">–</td>
</tr>
<tr class="even">
<td align="right"><strong>mmr_Ch4</strong></td>
<td align="left">See <code>mmr_Ch1</code> argument for description. This applies to Channel 4</td>
<td align="left">–</td>
</tr>
<tr class="odd">
<td align="right"><strong>clean_Ch1</strong></td>
<td align="left">Specific to MMR cycle for each animal (or cycle). A time window (min) that specifies a quality section on metabolic rate measurement to be used. This may be used to “clean” the data. Default will use full length measurement cycle as set by <code>cycle_start</code> and <code>cycle_end</code> arguments.</td>
<td align="left"><code>c(0,0)</code></td>
</tr>
<tr class="even">
<td align="right"><strong>clean_Ch2</strong></td>
<td align="left">See <code>clean_Ch1</code> argument for description. This applies to Channel 2</td>
<td align="left">–</td>
</tr>
<tr class="odd">
<td align="right"><strong>clean_Ch3</strong></td>
<td align="left">See <code>clean_Ch1</code> argument for description. This applies to Channel 3</td>
<td align="left">–</td>
</tr>
<tr class="even">
<td align="right"><strong>clean_Ch4</strong></td>
<td align="left">See <code>clean_Ch1</code> argument for description. This applies to Channel 4</td>
<td align="left">–</td>
</tr>
<tr class="odd">
<td align="right"><strong>N_Ch</strong></td>
<td align="left">The number of FireSting channels. Options include 2, 4, 8. Note, if either a 2- or 4-Channel FireSting was used, this argument can be ignored.</td>
<td align="left"><code>4</code></td>
</tr>
<tr class="even">
<td align="right"><strong>path</strong></td>
<td align="left">Specify working directory for all output files. This argument has two options, i) files can be automatically organized in newly created local directories. Any character may be used.</td>
<td align="left"><code>"."</code> (local directory)</td>
</tr>
<tr class="odd">
<td align="right"><strong>date_format</strong></td>
<td align="left">The date format used in the original FireSting files. Must specify one of the following: <code>c("m/d/y","d/m/y","y-m-d")</code></td>
<td align="left"><code>"m/d/y"</code></td>
</tr>
</tbody>
</table>
<br>
<h4>
<a name="Value" style="color:#495057; font-weight: bold;  text-align: left">Value</a>
</h4>
<p>Finding best representation of MMR.</p>
<h5 style="color:#495057; font-weight: bold;  text-align: left; text-indent:+10px;">
<i class="fas fa-ellipsis-h"></i>  Data outputs
</h5>
<ol style="list-style-type: decimal">
<li><em>.csv files</em></li>
</ol>
<ul>
<li>()_SLIDINGsetCh2.csv
<ul>
<li>Local dir: channel_sliding_sets</li>
<li>Primary metrics included: regression parameters (slope = m, intercept = b, and R<sub>2</sub>) of each “sliding” slope, length (60 s, 90 s, 120 s, 180 s) timeframe of each slope, and temperature (ºC).</li>
</ul></li>
<li>()_analyzed.csv
<ul>
<li>Local dir(s): csv_analyzed (in two parent directories: MANUAL/csv_analyzed, MMR_SMR_AS_EPOC/csv_analyzed)</li>
<li>Primary metrics included: the steepest slope for each MMR timeframe(60 s, 90 s, 120 s, 180 s), respective regression parameters of those slopes, temparature; the same parameters are provided for the consecutive measurement cycles.</li>
</ul></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><em>.png files</em></li>
</ol>
<ul>
<li>()_ChX.png (X = the number of channel)
<ul>
<li>Local dir: channel_plots</li>
<li>Multipanel figure showing the MMR cycle and overlaid colored regression slopes with for all sliding windows</li>
</ul></li>
<li>()_SLIDING_MMRanalysisChX.png
<ul>
<li>Local dir: channel_plots_MMRanalysis</li>
<li>Analytical boxplot with all sliding slopes and their R<sub>2</sub> plotted. This can be informative to select values best representing MMR of the animal. (literature on extended methods: <a href="https://doi.org/10.1086/708673">Little et al 2021, Physiological and Biochemical Zoology</a>)</li>
</ul></li>
</ul>
<br>
<h4>
<a name="Details" style="color:#495057; font-weight: bold;  text-align: left">Details</a>
</h4>
<p><br></p>
<p>The timeframes of MMR cycles can be quality controlled to select only high quality desired data parts (e.g. exclude any blips, etc, that appear due to experimental or technical reasons). See relevant suggestions in <a href="./QC_protocol.html" style = "color:#8e8c84; font-weight:bold;">QC section</a> for more information. There are two types of quality control.</p>
<ol style="list-style-type: decimal">
<li>MMR cycles: use arg <code>clean_ChX = c(,)</code></li>
<li>The cycles: use arg <code>inv.data = "xyz.csv"</code>; external MMR cleaning or inventory datafile (.csv) to document and apply changes.</li>
</ol>
<p>We call these inventory files to create traceable and clear selection of all manually applied changes. Template can be found <a href="herehere">here on GitHub page</a> <strong>Important</strong>: All channels are assumed to work on the same open:closed cycle regimen.</p>
<br>
<h5 style="color:#495057; font-weight: bold;  text-align: left; text-indent:+10px;">
<i class="fas fa-ellipsis-h"></i>  Support functions
</h5>
<p><code>MMRslide</code> Arguments: <a style="color:grey"> d, Ch, data.MMR, r, r_temp, newdata_set, newdata_mmr </a> <code>Channel_mmr</code> Arguments: <a style="color:grey">data.MMR, dataMMR, cycle_start, cycle_end, Ch_list, cycles, j, delays, rows, rows_temp, newdata_mmr, newdata_set</a></p>
<br>
<h5 style="color:#495057; font-weight: bold;  text-align: left; text-indent:+10px;">
<i class="fas fa-ellipsis-h"></i>  Messages in Console
</h5>
<ul>
<li><code>ChX: INVENTORY data, adjusting non-MMR cycle times</code>: indicates which that channel (X) will contaon adjusted measurement timeframe for non-MMR cycles</li>
<li><code>ChX: Several MMR slopes: n = X</code>: Indicates that channel (X) has several equally steep slopes for a given sliding timeframe (e.g. 60 s)
<ul>
<li><code>ChX: Steepest slopes have equivalently good R2, use the first slope recorded</code>: Contingent to the having several steepest slope, notes the final selection</li>
<li><code>ChX: Steepest slopes with best R2 selected</code>: Contingent to the having several steepest slope, notes the final selection</li>
</ul></li>
<li><code>NOT ANALYSED/ FILE &lt; 2 min</code>: File not analyses, requires more data</li>
<li><code>ChX: file &lt; 3 min: no steepest slope analysis</code>: No sliding analysis</li>
</ul>
<br>
<h4 style="color:#495057; font-weight: bold;  text-align: left;">
References
</h4>
<p><a href="https://doi.org/10.1086/708673">Little et al 2021, Physiological and Biochemical Zoology</a> This package was used to produce the data in this study.</p>
<br>
<h4>
<a name="Example" style="color:#495057; font-weight: bold;  text-align: left">Example</a>
</h4>
<p><br></p>
<pre class = "sourceCode yaml"> 

MMR(data.MMR="jul04_2019_opasize_box4_mmr.csv",
        cycles = 2,
        cycle_start = c(0,9.85),
        cycle_end = c(3,14.1),
        mmr_Ch1=1,mmr_Ch2=2,mmr_Ch3=1,mmr_Ch4=2,
        clean_Ch1=c(0,0),
        clean_Ch2=c(0,0),
        clean_Ch3=c(0,0),
        clean_Ch4=c(0,0),
        path ="Foldering", # times in minutes (relative time)
        N_Ch = 4,
        date_format = "m/d/y")#,


# using inventory data. 
MMR(data.MMR="jul04_2019_opasize_box4_mmr.csv",
        cycles = 2,
        cycle_start = c(0,9.85),
        cycle_end = c(3,14.1),
        mmr_Ch1=1,mmr_Ch2=2,mmr_Ch3=1,mmr_Ch4=2,
        clean_Ch1=c(0,0),
        clean_Ch2=c(0,0),
        clean_Ch3=c(0,0),
        clean_Ch4=c(0,0),
        path ="Foldering", # times in minutes (relative time)
        N_Ch = 4,
        date_format = "m/d/y",
        inv.data="MMR_template_TESTJan2022.csv")

</pre>

<br>
<br>
<br>
<br>
<br>
<br>
<br>
<div>
    <ul class = "pull-left" style = "color:grey; text-align:left;"> Krista Kraskura (kkraskura@ucsb.edu) <a href="https://bootswatch.com/3/sandstone/">Web theme here</a></ul>
</div>






</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
